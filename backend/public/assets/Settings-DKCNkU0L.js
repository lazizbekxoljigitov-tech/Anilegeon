import{u as ce,j as e,B as d,a as o,I as k}from"./index-CRKTpU-g.js";import{e as de,r as n,a1 as ue,U as z,a2 as xe,i as U,a0 as J,a3 as W,a4 as K,a5 as M,C as me,A as G,m as N,a6 as R,a7 as F,a8 as D,G as pe,f as O,a9 as he,_ as I,X as fe,z as r}from"./vendor-ui-BWBM4E-P.js";import"./i18n-lib-Bl3zpvLj.js";const ge=[{id:"account",label:"Account",icon:z},{id:"security",label:"Security",icon:xe},{id:"preferences",label:"Anime Preferences",icon:U},{id:"history",label:"Watch History",icon:J},{id:"privacy",label:"Privacy",icon:W},{id:"notifications",label:"Notifications",icon:K},{id:"danger",label:"Danger Zone",icon:M,color:"text-red-400"}],be=["Action","Adventure","Comedy","Drama","Fantasy","Horror","Mecha","Music","Mystery","Psychological","Romance","Sci-Fi","Slice of Life","Sports","Supernatural","Thriller"],ye=["Japan","South Korea","Uzbekistan","USA","China","Germany","France","Russia","Turkey","India","Other"],m=({enabled:s,onChange:f,label:g})=>e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("span",{className:"text-sm text-gray-300",children:g}),e.jsx("button",{onClick:()=>f(!s),className:`relative w-12 h-6 rounded-full transition-all duration-300 ${s?"bg-purple-500 shadow-lg shadow-purple-500/30":"bg-dark-accent"}`,children:e.jsx(N.div,{animate:{x:s?24:2},transition:{type:"spring",stiffness:500,damping:30},className:"absolute top-1 w-4 h-4 bg-white rounded-full shadow"})})]}),u=({title:s,children:f,icon:g,danger:b})=>e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`rounded-2xl border backdrop-blur-md p-6 mb-6 ${b?"bg-red-500/5 border-red-500/20":"bg-white/[0.02] border-white/[0.06]"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g&&e.jsx(g,{size:20,className:b?"text-red-400":"text-purple-400"}),e.jsx("h3",{className:`font-bold text-lg ${b?"text-red-400":"text-white"}`,children:s})]}),f]}),ke=()=>{const{user:s,updateUser:f,logout:g}=ce(),b=de(),[S,Q]=n.useState("account"),[je,ve]=n.useState(!1),[c,p]=n.useState({name:"",bio:"",gender:"",country:"",dob:""}),[H,V]=n.useState(null),T=n.useRef(null),[l,P]=n.useState({old:"",new:"",confirm:""}),[y,j]=n.useState({user_id:"",genres:[],language:"sub",autoplay:!0,quality:"720p",mature_content:!1}),[_,A]=n.useState({user_id:"",visibility:"public",show_status:!0,allow_requests:!0}),[v,w]=n.useState({user_id:"",email_notifications:!0,push_notifications:!0,episode_alerts:!0,comment_replies:!0,friend_requests:!0}),[L,$]=n.useState(""),[X,E]=n.useState(!1),[C,x]=n.useState(!1);n.useEffect(()=>{s&&p({name:s.name||"",bio:s.bio||"",gender:s.gender||"",country:s.country||"",dob:s.dob||""})},[s]),n.useEffect(()=>{(async()=>{try{const[t,i,h]=await Promise.all([o.get("/settings/preferences"),o.get("/settings/privacy"),o.get("/settings/notifications")]);t.data.success&&j(t.data.data),i.data.success&&A(i.data.data),h.data.success&&w(h.data.data)}catch{}})()},[]);const Y=async()=>{x(!0);try{const{data:a}=await o.put("/settings/profile",c);a.success&&(f(a.data),r.success("Profile updated!"))}catch{r.error("Failed to update profile")}finally{x(!1)}},Z=async a=>{var h;const t=(h=a.target.files)==null?void 0:h[0];if(!t)return;V(URL.createObjectURL(t));const i=new FormData;i.append("avatar",t);try{const{data:B}=await o.put("/auth/profile",i,{headers:{"Content-Type":"multipart/form-data"}});B.success&&(f(B.data),r.success("Avatar updated!"))}catch{r.error("Avatar upload failed")}},ee=async()=>{if(l.new!==l.confirm){r.error("Passwords do not match");return}if(l.new.length<6){r.error("Password must be at least 6 characters");return}x(!0);try{await o.put("/auth/change-password",{oldPassword:l.old,newPassword:l.new}),r.success("Password changed!"),P({old:"",new:"",confirm:""})}catch{r.error("Failed to change password")}finally{x(!1)}},ae=async()=>{x(!0);try{const{data:a}=await o.put("/settings/preferences",y);a.success&&r.success("Preferences saved!")}catch{r.error("Failed to save preferences")}finally{x(!1)}},se=async()=>{x(!0);try{const{data:a}=await o.put("/settings/privacy",_);a.success&&r.success("Privacy settings saved!")}catch{r.error("Failed to save privacy settings")}finally{x(!1)}},te=async()=>{x(!0);try{const{data:a}=await o.put("/settings/notifications",v);a.success&&r.success("Notification settings saved!")}catch{r.error("Failed to save notification settings")}finally{x(!1)}},re=async()=>{try{await o.delete("/settings/watch-history"),r.success("Watch history cleared!")}catch{r.error("Failed to clear history")}},ie=async()=>{try{const a=await o.get("/settings/watch-history/export",{responseType:"blob"}),t=URL.createObjectURL(new Blob([JSON.stringify(a.data,null,2)])),i=document.createElement("a");i.href=t,i.download="watch_history.json",i.click(),r.success("History downloaded!")}catch{r.error("Download failed")}},le=async()=>{if(L!=="DELETE"){r.error("Type DELETE to confirm");return}try{await o.post("/settings/delete-account",{confirmation:"DELETE"}),r.success("Account scheduled for deletion"),g(),b("/login")}catch{r.error("Failed to delete account")}},ne=async()=>{try{const a=await o.get("/settings/export-data"),t=URL.createObjectURL(new Blob([JSON.stringify(a.data,null,2)])),i=document.createElement("a");i.href=t,i.download="account_data.json",i.click(),r.success("Account data downloaded!")}catch{r.error("Download failed")}},q=(()=>{let a=0;return s!=null&&s.name&&(a+=20),s!=null&&s.avatar_url&&(a+=20),s!=null&&s.bio&&(a+=20),s!=null&&s.country&&(a+=20),s!=null&&s.dob&&(a+=20),a})(),oe=()=>{switch(S){case"account":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{title:"Profile Completion",icon:z,children:e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"Completion"}),e.jsxs("span",{className:"text-purple-400 font-bold",children:[q,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-dark-accent rounded-full overflow-hidden",children:e.jsx(N.div,{initial:{width:0},animate:{width:`${q}%`},transition:{duration:1,ease:"easeOut"},className:"h-full bg-gradient-to-r from-purple-500 to-blue-500 rounded-full"})})]})}),e.jsx(u,{title:"Profile Picture",icon:I,children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-24 h-24 rounded-2xl bg-dark-accent overflow-hidden border-2 border-purple-500/20",children:H||s!=null&&s.avatar_url?e.jsx("img",{src:H||(s==null?void 0:s.avatar_url),alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:e.jsx(z,{size:40})})}),e.jsx("button",{onClick:()=>{var a;return(a=T.current)==null?void 0:a.click()},className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl cursor-pointer",children:e.jsx(I,{className:"text-white",size:20})}),e.jsx("input",{ref:T,type:"file",className:"hidden",accept:"image/*",onChange:Z})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:s==null?void 0:s.email}),e.jsx("button",{onClick:()=>{var a;return(a=T.current)==null?void 0:a.click()},className:"mt-2 text-xs text-purple-400 hover:text-purple-300 transition",children:"Change Avatar"})]})]})}),e.jsxs(u,{title:"Account Information",icon:z,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{label:"Display Name",value:c.name,onChange:a=>p({...c,name:a.target.value})}),e.jsxs("div",{className:"w-full space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400 ml-1",children:"Gender"}),e.jsxs("select",{value:c.gender,onChange:a=>p({...c,gender:a.target.value}),className:"w-full bg-dark-accent border border-dark-border rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 transition-all",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsx(k,{label:"Date of Birth",type:"date",value:c.dob,onChange:a=>p({...c,dob:a.target.value})}),e.jsxs("div",{className:"w-full space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400 ml-1",children:"Country"}),e.jsxs("select",{value:c.country,onChange:a=>p({...c,country:a.target.value}),className:"w-full bg-dark-accent border border-dark-border rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 transition-all",children:[e.jsx("option",{value:"",children:"Select Country"}),ye.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400 ml-1",children:"Bio"}),e.jsx("textarea",{value:c.bio,onChange:a=>{a.target.value.length<=250&&p({...c,bio:a.target.value})},placeholder:"Tell us about yourself...",rows:3,className:"w-full mt-1.5 bg-dark-accent border border-dark-border rounded-lg px-4 py-2.5 text-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50 resize-none transition-all"}),e.jsxs("p",{className:"text-right text-xs text-gray-500 mt-1",children:[c.bio.length,"/250"]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsxs(d,{variant:"ghost",onClick:()=>{s&&p({name:s.name,bio:s.bio||"",gender:s.gender||"",country:s.country||"",dob:s.dob||""})},children:[e.jsx(fe,{size:16})," Cancel"]}),e.jsxs(d,{onClick:Y,isLoading:C,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 shadow-lg shadow-purple-500/20",children:[e.jsx(D,{size:16})," Save Changes"]})]})]})]});case"security":return e.jsx(u,{title:"Change Password",icon:O,children:e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsx(k,{label:"Current Password",type:"password",value:l.old,onChange:a=>P({...l,old:a.target.value})}),e.jsx(k,{label:"New Password",type:"password",value:l.new,onChange:a=>P({...l,new:a.target.value})}),e.jsx(k,{label:"Confirm New Password",type:"password",value:l.confirm,onChange:a=>P({...l,confirm:a.target.value}),error:l.confirm&&l.new!==l.confirm?"Passwords do not match":void 0}),e.jsxs(d,{onClick:ee,isLoading:C,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 mt-4",children:[e.jsx(O,{size:16})," Update Password"]})]})});case"preferences":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{title:"Favorite Genres",icon:U,children:e.jsx("div",{className:"flex flex-wrap gap-2",children:be.map(a=>{const t=y.genres.includes(a);return e.jsxs("button",{onClick:()=>{j(i=>({...i,genres:t?i.genres.filter(h=>h!==a):[...i.genres,a]}))},className:`px-4 py-2 rounded-xl text-sm font-medium transition-all border ${t?"bg-purple-500/20 border-purple-500/50 text-purple-300 shadow-lg shadow-purple-500/10":"bg-dark-accent border-dark-border text-gray-400 hover:border-purple-500/30"}`,children:[t&&e.jsx(he,{size:12,className:"inline mr-1"}),a]},a)})})}),e.jsxs(u,{title:"Playback Settings",icon:U,children:[e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Preferred Language"}),e.jsx("div",{className:"flex gap-3",children:["sub","dub"].map(a=>e.jsx("button",{onClick:()=>j(t=>({...t,language:a})),className:`flex-1 py-3 rounded-xl text-sm font-bold uppercase tracking-wider transition-all border ${y.language===a?"bg-purple-500/20 border-purple-500/50 text-purple-300":"bg-dark-accent border-dark-border text-gray-400"}`,children:a==="sub"?"ðŸ‡¯ðŸ‡µ Subbed":"ðŸ‡¬ðŸ‡§ Dubbed"},a))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Default Quality"}),e.jsx("div",{className:"flex gap-2",children:["480p","720p","1080p"].map(a=>e.jsx("button",{onClick:()=>j(t=>({...t,quality:a})),className:`flex-1 py-3 rounded-xl text-sm font-bold transition-all border ${y.quality===a?"bg-purple-500/20 border-purple-500/50 text-purple-300":"bg-dark-accent border-dark-border text-gray-400"}`,children:a},a))})]}),e.jsx(m,{label:"Autoplay Next Episode",enabled:y.autoplay,onChange:a=>j(t=>({...t,autoplay:a}))}),e.jsx(m,{label:"Show Mature Content",enabled:y.mature_content,onChange:a=>j(t=>({...t,mature_content:a}))})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(d,{onClick:ae,isLoading:C,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500",children:[e.jsx(D,{size:16})," Save Preferences"]})})]})]});case"history":return e.jsx(u,{title:"Watch History",icon:J,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Manage your watch history data. Clearing history cannot be undone."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(d,{variant:"secondary",onClick:ie,className:"border border-dark-border",children:[e.jsx(F,{size:16})," Download History (JSON)"]}),e.jsxs(d,{variant:"danger",onClick:re,children:[e.jsx(R,{size:16})," Clear All History"]})]})]})});case"privacy":return e.jsx(u,{title:"Privacy Settings",icon:W,children:e.jsxs("div",{className:"space-y-6 max-w-md",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Profile Visibility"}),e.jsx("div",{className:"flex gap-2",children:["public","friends","private"].map(a=>e.jsxs("button",{onClick:()=>A(t=>({...t,visibility:a})),className:`flex-1 py-3 rounded-xl text-sm font-bold capitalize transition-all border ${_.visibility===a?"bg-purple-500/20 border-purple-500/50 text-purple-300":"bg-dark-accent border-dark-border text-gray-400"}`,children:[a==="public"&&e.jsx(pe,{size:14,className:"inline mr-1"}),a==="private"&&e.jsx(O,{size:14,className:"inline mr-1"}),a]},a))})]}),e.jsx(m,{label:"Show Online Status",enabled:_.show_status,onChange:a=>A(t=>({...t,show_status:a}))}),e.jsx(m,{label:"Allow Friend Requests",enabled:_.allow_requests,onChange:a=>A(t=>({...t,allow_requests:a}))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(d,{onClick:se,isLoading:C,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500",children:[e.jsx(D,{size:16})," Save Privacy Settings"]})})]})});case"notifications":return e.jsxs(u,{title:"Notification Preferences",icon:K,children:[e.jsxs("div",{className:"space-y-1 max-w-md",children:[e.jsx(m,{label:"Email Notifications",enabled:v.email_notifications,onChange:a=>w(t=>({...t,email_notifications:a}))}),e.jsx(m,{label:"Push Notifications",enabled:v.push_notifications,onChange:a=>w(t=>({...t,push_notifications:a}))}),e.jsx("div",{className:"border-t border-dark-border my-4"}),e.jsx(m,{label:"New Episode Alerts",enabled:v.episode_alerts,onChange:a=>w(t=>({...t,episode_alerts:a}))}),e.jsx(m,{label:"Comment Replies",enabled:v.comment_replies,onChange:a=>w(t=>({...t,comment_replies:a}))}),e.jsx(m,{label:"Friend Requests",enabled:v.friend_requests,onChange:a=>w(t=>({...t,friend_requests:a}))})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(d,{onClick:te,isLoading:C,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500",children:[e.jsx(D,{size:16})," Save Notifications"]})})]});case"danger":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{title:"Export Your Data",icon:F,children:[e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Download all your account data including profile, preferences, watch history, and saved anime."}),e.jsxs(d,{variant:"secondary",onClick:ne,className:"border border-dark-border",children:[e.jsx(F,{size:16})," Download Account Data"]})]}),e.jsxs(u,{title:"Delete Account",icon:M,danger:!0,children:[e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Once you delete your account, you have ",e.jsx("span",{className:"text-red-400 font-bold",children:"30 days"})," to recover it. After that, all data is permanently erased."]}),e.jsxs(d,{variant:"danger",onClick:()=>E(!0),children:[e.jsx(R,{size:16})," Delete My Account"]})]})]})}};return e.jsxs("div",{className:"container mx-auto px-4 py-8 md:py-12 max-w-6xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-10 md:mb-12",children:[e.jsx("button",{onClick:()=>b("/profile"),className:"p-2.5 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all",children:e.jsx(ue,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-black italic uppercase tracking-tighter text-white",children:"Settings"}),e.jsx("p",{className:"text-gray-500 text-xs md:text-sm font-bold uppercase tracking-widest",children:"Manage your account and preferences"})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 md:gap-12",children:[e.jsx("aside",{className:"w-full lg:w-72 flex-shrink-0",children:e.jsx("div",{className:"flex lg:flex-col gap-2 overflow-x-auto lg:overflow-x-visible pb-4 lg:pb-0 scrollbar-hide lg:sticky lg:top-24",children:ge.map(a=>{const t=a.icon;return e.jsxs("button",{onClick:()=>Q(a.id),className:`flex items-center gap-3 px-5 py-3.5 rounded-xl text-[10px] md:text-xs font-black uppercase tracking-widest transition-all whitespace-nowrap border ${S===a.id?a.color?"bg-red-500/10 text-red-400 border-red-500/20":"bg-primary text-white border-primary shadow-lg shadow-primary/20":"text-gray-500 bg-white/5 border-white/5 hover:bg-white/10 hover:text-gray-300"}`,children:[e.jsx(t,{size:18}),a.label,S===a.id&&e.jsx(me,{size:16,className:"ml-auto hidden lg:block opacity-50"})]},a.id)})})}),e.jsx("main",{className:"flex-1 min-w-0",children:e.jsx(G,{mode:"wait",children:e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:e.jsx("div",{className:"bg-dark-light/10 md:bg-transparent rounded-3xl p-1 md:p-0",children:oe()})},S)})})]}),e.jsx(G,{children:X&&e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>E(!1),children:e.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-dark-light border border-red-500/20 rounded-2xl p-6 max-w-md w-full",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center",children:e.jsx(M,{className:"text-red-400",size:20})}),e.jsx("h3",{className:"text-lg font-bold text-red-400",children:"Delete Account"})]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-6",children:["This action is irreversible after 30 days. Type ",e.jsx("span",{className:"text-red-400 font-mono font-bold",children:"DELETE"})," to confirm."]}),e.jsx("input",{type:"text",value:L,onChange:a=>$(a.target.value),placeholder:"Type DELETE here",className:"w-full bg-dark-accent border border-red-500/20 rounded-lg px-4 py-2.5 text-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500/50 font-mono mb-4"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(d,{variant:"ghost",onClick:()=>{E(!1),$("")},children:"Cancel"}),e.jsxs(d,{variant:"danger",onClick:()=>{le(),E(!1)},disabled:L!=="DELETE",children:[e.jsx(R,{size:16})," Delete Forever"]})]})]})})})]})};export{ke as Settings};
