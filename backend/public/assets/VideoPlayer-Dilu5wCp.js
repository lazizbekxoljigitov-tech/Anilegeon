import{j as e,B as Y}from"./index-C5JwLfAb.js";import{r as a,$ as V,ax as q,ay as ee,az as te,P as E,aA as se,aB as re,aC as ae,aD as ne,aE as ie,aF as le}from"./vendor-ui-BWBM4E-P.js";import{u as oe}from"./i18n-lib-Bl3zpvLj.js";const pe=({url:u,qualities:n,onEnded:v,title:_,externalState:x,onStateChange:ce,isSyncing:B})=>{const r=a.useRef(null),h=a.useRef(null),[o,K]=a.useState(!1),[w,S]=a.useState(0),[j,Q]=a.useState(0),[M,U]=a.useState(1),[b,P]=a.useState(!1),[N,k]=a.useState(!0),[p,W]=a.useState("1080p"),[f,C]=a.useState(!1),{t:X}=oe(),[Z,I]=a.useState(!1),m=a.useRef(),T=a.useRef(0),R=(()=>{switch(p){case"720p":return(n==null?void 0:n["720p"])||u;case"1080p":return(n==null?void 0:n["1080p"])||u;case"4K (AI)":return(n==null?void 0:n["4k"])||(n==null?void 0:n["1080p"])||u;default:return u}})(),G=p==="4K (AI)"?{filter:"url(#premium-sharpen) contrast(1.1) brightness(1.02) saturate(1.1)",imageRendering:"high-quality"}:{imageRendering:"auto"},H=t=>{var l,c;const s=((l=r.current)==null?void 0:l.currentTime)||0,i=!((c=r.current)!=null&&c.paused);W(t),C(!1),setTimeout(()=>{r.current&&(r.current.currentTime=s,i&&r.current.play())},100)},$=a.useCallback(()=>{o&&(k(!1),C(!1))},[o]),y=a.useCallback(()=>{k(!0),m.current&&clearTimeout(m.current),m.current=setTimeout($,4e3)},[$]);a.useEffect(()=>{const t=r.current;if(!t)return;const s=()=>S(t.currentTime),i=()=>Q(t.duration);return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",i),t.addEventListener("ended",v||(()=>{})),B&&x&&t&&(Math.abs(t.currentTime-x.currentTime)>1.5&&(t.currentTime=x.currentTime),x.isPlaying&&t.paused&&t.play(),!x.isPlaying&&!t.paused&&t.pause()),m.current&&clearTimeout(m.current),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",i),t.removeEventListener("ended",v||(()=>{})),m.current&&clearTimeout(m.current)}},[v,R]);const A=()=>{r.current&&(o?r.current.pause():r.current.play(),K(!o),y())},F=()=>{h.current&&(document.fullscreenElement?(document.exitFullscreen(),I(!1)):(h.current.requestFullscreen(),I(!0)))},O=t=>{var d;const s=Date.now(),i=s-T.current,l=((d=h.current)==null?void 0:d.offsetWidth)||0,c=t.nativeEvent.offsetX;i<300?(c>l*.7?r.current&&(r.current.currentTime+=5):c<l*.3?r.current&&(r.current.currentTime-=5):F(),T.current=0):(A(),T.current=s)},J=t=>{const s=parseFloat(t.target.value);r.current&&(r.current.currentTime=s,S(s)),y()},L=t=>{const s=Math.floor(t/60),i=Math.floor(t%60);return`${s}:${i<10?"0":""}${i}`},[g,z]=a.useState(null);return a.useEffect(()=>{var s,i;const t=u;if(t.includes("t.me/")){const l=(s=t.split("t.me/")[1])==null?void 0:s.split("?")[0];if(l){z(`telegram:${l}`);const c=document.getElementById("telegram-post-container");c&&(c.innerHTML="");const d=document.createElement("script");d.src="https://telegram.org/js/telegram-widget.js?22",d.setAttribute("data-telegram-post",l),d.setAttribute("data-width","100%"),d.async=!0,setTimeout(()=>{const D=document.getElementById("telegram-post-container");D&&D.appendChild(d)},100)}}else if(t.includes("youtube.com/watch?v=")||t.includes("youtu.be/")){const l=((i=t.split("v=")[1])==null?void 0:i.split("&")[0])||t.split("/").pop();z(`https://www.youtube.com/embed/${l}`)}else z(null)},[u]),e.jsxs("div",{ref:h,className:`relative group w-full aspect-video bg-black rounded-3xl overflow-hidden shadow-2xl border border-dark-border/30 transition-all duration-700 ${N?"cursor-default":"cursor-none"}`,onMouseMove:y,onMouseLeave:()=>o&&k(!1),onTouchStart:y,children:[g?g.startsWith("telegram:")?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black p-4 overflow-y-auto",children:e.jsx("div",{id:"telegram-post-container",className:"w-full max-w-md"})}):e.jsx("iframe",{src:g,className:"w-full h-full border-none",allowFullScreen:!0,allow:"autoplay; encrypted-media"}):e.jsx("video",{ref:r,src:R,className:"w-full h-full object-contain transition-all duration-500",style:{...G,backfaceVisibility:"hidden",transform:"translateZ(0)"},onClick:O,playsInline:!0}),p==="4K (AI)"&&o&&e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 opacity-[0.03] animate-pulse bg-white transition-opacity duration-1000",style:{animationDuration:"0.05s"}}),!g&&e.jsxs("div",{className:`absolute inset-0 flex flex-col justify-between p-4 md:p-10 transition-all duration-500 ease-in-out pointer-events-none ${N?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between pointer-events-auto transform transition-transform duration-500 delay-75 translate-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-4 bg-black/40 backdrop-blur-xl border border-white/10 px-4 md:px-6 py-2 md:py-3 rounded-xl md:rounded-2xl max-w-[70%]",children:[e.jsx("div",{className:"w-1.5 h-1.5 md:w-2 md:h-2 bg-primary rounded-full animate-pulse shadow-[0_0_10px_rgba(255,59,48,0.8)] shrink-0"}),e.jsx("h3",{className:"text-xs md:text-lg font-black italic uppercase tracking-tighter text-white truncate",children:_||"ANILEGEON Premium Player"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(Y,{variant:"ghost",size:"icon",onClick:()=>C(!f),"aria-label":"Video settings and quality",className:`w-9 h-9 md:w-10 md:h-10 bg-black/40 backdrop-blur-xl border border-white/10 text-white hover:text-primary transition-all pointer-events-auto ${f?"text-primary border-primary/50":""}`,children:[e.jsx(V,{size:18,className:f?"rotate-90 transition-transform":"md:hidden"}),e.jsx(V,{size:20,className:f?"rotate-90 transition-transform":"hidden md:block"})]})})]}),f&&e.jsxs("div",{className:"absolute top-16 md:top-24 right-4 md:right-10 w-48 md:w-56 bg-black/80 backdrop-blur-2xl border border-white/10 rounded-2xl md:rounded-3xl p-2 md:p-3 shadow-2xl z-50 pointer-events-auto animate-in fade-in zoom-in duration-200",children:[e.jsx("div",{className:"text-[9px] md:text-[10px] font-black uppercase tracking-[0.2em] text-gray-500 px-3 md:px-4 py-1.5 md:py-2 border-b border-white/5 mb-1 md:mb-2",children:X("watchParty.select_anime")}),["720p","1080p","1440p","4K (AI)"].map(t=>e.jsxs("button",{onClick:()=>H(t),className:`w-full flex items-center justify-between px-4 py-3 rounded-2xl text-xs font-bold transition-all ${p===t?"bg-primary text-white shadow-lg shadow-primary/20":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsxs("span",{className:"flex items-center gap-3",children:[t==="4K (AI)"?e.jsx(q,{size:14,className:"text-yellow-400"}):e.jsx(ee,{size:14}),t]}),p===t&&e.jsx(te,{size:14})]},t))]}),e.jsx("div",{className:"flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:`transform transition-all duration-500 ${!o&&N?"scale-100 opacity-100":"scale-150 opacity-0"}`,children:e.jsxs("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-primary/20 backdrop-blur-3xl border border-primary/30 rounded-full flex items-center justify-center",children:[e.jsx(E,{size:24,className:"text-white fill-white ml-1 md:hidden"}),e.jsx(E,{size:40,className:"text-white fill-white ml-2 hidden md:block"})]})})}),e.jsxs("div",{className:"space-y-6 pointer-events-auto transform transition-transform duration-500 translate-y-0",children:[e.jsxs("div",{className:"relative group/progress h-2 w-full bg-white/10 rounded-full cursor-pointer overflow-hidden backdrop-blur-sm",children:[e.jsx("input",{type:"range",min:"0",max:j||0,value:w,onChange:J,"aria-label":"Seek video",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-primary to-orange-500 shadow-[0_0_15px_rgba(255,59,48,0.5)] transition-all duration-100",style:{width:`${w/j*100}%`}})]}),e.jsxs("div",{className:"flex items-center justify-between bg-black/60 md:bg-black/40 backdrop-blur-2xl border border-white/10 p-3 md:p-4 rounded-xl md:rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[e.jsx("button",{onClick:A,"aria-label":o?"Pause video":"Play video",className:"text-white hover:text-primary transition-all transform active:scale-90",children:o?e.jsx(se,{size:24,className:"md:w-8 md:h-8",fill:"currentColor"}):e.jsx(E,{size:24,className:"md:w-8 md:h-8",fill:"currentColor"})}),e.jsxs("div",{className:"text-[10px] md:text-xs font-black tracking-[0.1em] md:tracking-[0.2em] text-gray-300 font-mono",children:[e.jsx("span",{className:"text-white",children:L(w)}),e.jsx("span",{className:"mx-1.5 md:mx-3 opacity-30",children:"/"}),e.jsx("span",{className:"opacity-50",children:L(j)})]})]}),e.jsxs("div",{className:"flex items-center gap-3 md:gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 group/volume",children:[e.jsx("button",{onClick:()=>P(!b),"aria-label":b?"Unmute video":"Mute video",className:"text-gray-400 hover:text-white transition-colors",children:b||M===0?e.jsx(re,{size:18,className:"md:w-[22px] md:h-[22px]"}):e.jsx(ae,{size:18,className:"md:w-[22px] md:h-[22px]"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:b?0:M,onChange:t=>{const s=parseFloat(t.target.value);U(s),r.current&&(r.current.volume=s),P(s===0)},"aria-label":"Change volume",className:"w-16 md:w-20 accent-primary opacity-0 group-hover/volume:opacity-100 transition-all cursor-pointer hidden md:block"})]}),e.jsx("div",{className:"h-4 md:h-6 w-px bg-white/10"}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx("div",{className:"text-[8px] md:text-[10px] font-black uppercase tracking-widest text-primary px-1.5 md:px-3 py-0.5 md:py-1 bg-primary/10 border border-primary/20 rounded-md md:rounded-lg",children:p}),e.jsx("button",{onClick:F,"aria-label":Z?"Exit fullscreen":"Enter fullscreen",className:"text-gray-400 hover:text-white transition-all transform hover:scale-110 active:scale-90",children:e.jsx(ne,{size:18,className:"md:w-[22px] md:h-[22px]"})})]})]})]})]})]}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx("div",{className:"flex-1 flex items-center justify-start pl-20 opacity-0 group-active:opacity-20 transition-opacity",children:e.jsx(ie,{size:64,className:"text-white"})}),e.jsx("div",{className:"flex-1 flex items-center justify-end pr-20 opacity-0 group-active:opacity-20 transition-opacity",children:e.jsx(le,{size:64,className:"text-white"})})]}),e.jsx("svg",{className:"hidden",children:e.jsx("filter",{id:"premium-sharpen",children:e.jsx("feConvolveMatrix",{order:"3",preserveAlpha:"true",kernelMatrix:"0 -1.2 0 -1.2 5.8 -1.2 0 -1.2 0"})})})]})};export{pe as V};
