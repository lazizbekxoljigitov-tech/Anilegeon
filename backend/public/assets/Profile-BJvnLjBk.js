import{u as E,j as e,B as b,a as n}from"./index-CRKTpU-g.js";import{r as i,e as T,N as D,U as B,_ as L,$ as M,c as R,a0 as f,w as j,A as U,m as y,z as v}from"./vendor-ui-BWBM4E-P.js";import{A as w}from"./AnimeCard-DNBUoIz0.js";import{S as N}from"./SkeletonCard-kwhCOLwW.js";import{u as $}from"./i18n-lib-Bl3zpvLj.js";const Y=()=>{const{t}=$(),{user:s,isAuthenticated:d,logout:k,updateUser:S}=E(),[m,z]=i.useState([]),[x,A]=i.useState([]),[o,p]=i.useState("history"),[h,g]=i.useState(!0),_=T();i.useEffect(()=>{if(!d)return;(async()=>{g(!0);try{const[r,l]=await Promise.all([n.get("/users/history"),n.get("/users/saved")]);z(r.data.data),A(l.data.data)}catch{console.error("Failed to fetch profile data")}finally{g(!1)}})()},[d]);const C=async a=>{var u;const r=(u=a.target.files)==null?void 0:u[0];if(!r)return;const l=new FormData;l.append("avatar",r);try{const{data:c}=await n.put("/auth/profile",l,{headers:{"Content-Type":"multipart/form-data"}});c.success&&(S(c.data),v.success("Avatar updated successfully!"))}catch{v.error("Failed to update avatar")}};return d?e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("header",{className:"mb-12",children:[e.jsxs("div",{className:"relative h-48 md:h-64 w-full rounded-2xl md:rounded-3xl overflow-hidden mb-[-60px] md:mb-[-80px] shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/30 via-dark-surface to-dark-bg"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-bg via-dark-bg/60 to-transparent"})]}),e.jsxs("div",{className:"relative px-4 md:px-8 flex flex-col md:flex-row items-center md:items-end gap-6 text-center md:text-left",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-32 h-32 md:w-40 md:h-40 rounded-2xl md:rounded-3xl bg-dark-accent border-4 border-dark-bg overflow-hidden shadow-2xl transition-transform duration-500 group-hover:scale-105",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-700 bg-dark-light",children:e.jsx(B,{size:64,className:"md:w-16 md:h-16 w-12 h-12"})})}),e.jsxs("label",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 cursor-pointer rounded-2xl md:rounded-3xl",children:[e.jsx(L,{className:"text-white",size:28}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:C})]})]}),e.jsxs("div",{className:"flex-grow pb-2",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-black italic uppercase tracking-tighter mb-1 text-white leading-tight",children:s==null?void 0:s.name}),e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary text-[10px] font-black uppercase tracking-widest rounded-md border border-primary/30",children:(s==null?void 0:s.role)==="admin"?"SYSTEM ADMIN":"ELITE MEMBER"}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-[10px]",children:t("profile.account")})]})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 pb-2 w-full md:w-auto",children:[e.jsxs(b,{variant:"secondary",className:"flex-1 md:flex-none bg-white/5 border border-white/10 backdrop-blur-md hover:bg-white/10",onClick:()=>_("/settings"),children:[e.jsx(M,{size:18}),e.jsx("span",{className:"hidden md:inline",children:t("profile.settings")})]}),e.jsxs(b,{onClick:k,variant:"danger",className:"flex-1 md:flex-none bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white border border-red-500/20",children:[e.jsx(R,{size:18}),e.jsx("span",{className:"hidden md:inline",children:t("profile.logout")})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 md:gap-12 mt-16 md:mt-20",children:[e.jsx("aside",{className:"lg:col-span-1 lg:border-r border-dark-border/30 lg:pr-8",children:e.jsxs("div",{className:"flex lg:flex-col gap-2 overflow-x-auto lg:overflow-x-visible pb-4 lg:pb-0 scrollbar-hide",children:[e.jsxs("button",{onClick:()=>p("history"),className:`flex-1 lg:flex-none flex items-center gap-3 md:gap-4 px-5 md:px-6 py-3 md:py-4 rounded-xl font-bold uppercase tracking-widest text-[10px] md:text-xs transition-all whitespace-nowrap ${o==="history"?"bg-primary text-white shadow-lg shadow-primary/30 border border-primary":"text-gray-500 bg-white/5 border border-white/5 hover:bg-dark-accent"}`,children:[e.jsx(f,{size:16,className:"md:w-[18px] md:h-[18px]"}),t("profile.watch_history")]}),e.jsxs("button",{onClick:()=>p("watchlist"),className:`flex-1 lg:flex-none flex items-center gap-3 md:gap-4 px-5 md:px-6 py-3 md:py-4 rounded-xl font-bold uppercase tracking-widest text-[10px] md:text-xs transition-all whitespace-nowrap ${o==="watchlist"?"bg-primary text-white shadow-lg shadow-primary/30 border border-primary":"text-gray-500 bg-white/5 border border-white/5 hover:bg-dark-accent"}`,children:[e.jsx(j,{size:16,className:"md:w-[18px] md:h-[18px]"}),t("profile.my_watchlist")]})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(U,{mode:"wait",children:o==="history"?e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("h3",{className:"text-2xl font-black italic uppercase tracking-tighter mb-8 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-1 bg-primary rounded-full"}),t("profile.continue_watching")]}),h?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[1,2,3].map(a=>e.jsx(N,{},a))}):m.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:m.map(a=>e.jsxs("div",{className:"relative group",children:[e.jsx(w,{anime:a.anime}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-primary h-full",style:{width:`${a.progress}%`}})})]},a.id))}):e.jsxs("div",{className:"py-20 text-center bg-dark-light/20 rounded-3xl border border-dark-border/30",children:[e.jsx(f,{size:48,className:"mx-auto text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm",children:t("profile.no_history")})]})]},"history"):e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("h3",{className:"text-2xl font-black italic uppercase tracking-tighter mb-8 flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-1 bg-primary rounded-full"}),t("profile.saved_for_later")]}),h?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[1,2,3].map(a=>e.jsx(N,{},a))}):x.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:x.map(a=>e.jsx(w,{anime:a.anime},a.anime.id))}):e.jsxs("div",{className:"py-20 text-center bg-dark-light/20 rounded-3xl border border-dark-border/30",children:[e.jsx(j,{size:48,className:"mx-auto text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-sm",children:t("profile.no_watchlist")})]})]},"watchlist")})})]})]}):e.jsx(D,{to:"/login",replace:!0})};export{Y as Profile};
