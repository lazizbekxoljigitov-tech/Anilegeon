import{u as E,j as e,I as u,B as j,a as g}from"./index-C5JwLfAb.js";import{r as i,e as F,m as N,P as q,ab as v,f as k,L as A,X as I,z as c}from"./vendor-ui-BWBM4E-P.js";import{u as _}from"./i18n-lib-Bl3zpvLj.js";const O=()=>{const[x,P]=i.useState(""),[y,S]=i.useState(""),[w,m]=i.useState(!1),[C,p]=i.useState(!1),[t,h]=i.useState("email"),[a,f]=i.useState({email:"",otp:"",newPassword:""}),b=F(),z=E(s=>s.setAuth),{t:l}=_(),L=async s=>{var n,d,r;s.preventDefault(),m(!0);try{const{data:o}=await g.post("/auth/login",{email:x,password:y});o.success&&(z(o.data.user,o.data.token),c.success(l("auth.welcome_back")+" to ANILEGEON!"),b("/"))}catch(o){((n=o.response)==null?void 0:n.status)===403?(c.error("Please verify your email. Verification code sent."),b("/register",{state:{email:x}})):c.error(((r=(d=o.response)==null?void 0:d.data)==null?void 0:r.error)||"Failed to login. Please check your credentials.")}finally{m(!1)}},D=async s=>{var n,d;s.preventDefault(),m(!0);try{if(t==="email"){const{data:r}=await g.post("/auth/forgot-password",{email:a.email});r.success&&(c.success("Reset code sent to your email"),h("otp"))}else if(t==="otp")h("new-password");else if(t==="new-password"){const{data:r}=await g.post("/auth/reset-password",{email:a.email,otp:a.otp,newPassword:a.newPassword});r.success&&(c.success("Password updated successfully! Please login."),p(!1),h("email"))}}catch(r){c.error(((d=(n=r.response)==null?void 0:n.data)==null?void 0:d.error)||"Operation failed")}finally{m(!1)}};return e.jsxs("div",{className:"container mx-auto px-6 h-screen flex items-center justify-center",children:[e.jsx(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-dark-light/40 backdrop-blur-xl border border-dark-border/50 p-10 rounded-3xl shadow-2xl",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-primary/30",children:e.jsx(q,{className:"text-white fill-white",size:32})}),e.jsxs("h2",{className:"text-3xl font-black italic tracking-tighter uppercase",children:[l("auth.welcome_back")," ",e.jsx("span",{className:"text-primary",children:"Back"})]}),e.jsx("p",{className:"text-gray-500 mt-2 text-center",children:l("auth.login_prompt")})]}),e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-[38px] text-gray-500",size:20}),e.jsx(u,{label:l("auth.email"),placeholder:"you@example.com",type:"email",className:"pl-10",required:!0,value:x,onChange:s=>P(s.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-[38px] text-gray-500",size:20}),e.jsx(u,{label:l("auth.password"),placeholder:"••••••••",type:"password",className:"pl-10",required:!0,value:y,onChange:s=>S(s.target.value)})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-primary hover:underline",children:"Forgot Password?"})}),e.jsx(j,{type:"submit",className:"w-full py-4 text-lg",isLoading:w,children:l("common.login")})]}),e.jsxs("p",{className:"mt-8 text-center text-gray-500",children:["Don't have an account?"," ",e.jsx(A,{to:"/register",className:"text-primary font-bold hover:underline",children:l("auth.create_account")})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 bg-black/80 backdrop-blur-sm",children:e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-md bg-dark-bg border border-white/10 p-8 rounded-3xl shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Reset Password"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-white",children:e.jsx(I,{size:24})})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[t==="email"&&e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-[38px] text-gray-500",size:20}),e.jsx(u,{label:"Email Address",placeholder:"you@example.com",type:"email",className:"pl-10",required:!0,value:a.email,onChange:s=>f({...a,email:s.target.value})})]}),t==="otp"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:"6-Digit Code"}),e.jsx("input",{type:"text",maxLength:6,placeholder:"000000",className:"w-full bg-black/40 border border-dark-border/50 rounded-xl py-4 text-center text-3xl font-bold tracking-[0.5em] text-primary focus:outline-none focus:border-primary transition-all",required:!0,value:a.otp,onChange:s=>f({...a,otp:s.target.value.replace(/\D/g,"")})}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Enter the code sent to your email"})]}),t==="new-password"&&e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-[38px] text-gray-500",size:20}),e.jsx(u,{label:"New Password",placeholder:"••••••••",type:"password",className:"pl-10",required:!0,value:a.newPassword,onChange:s=>f({...a,newPassword:s.target.value})})]}),e.jsx(j,{type:"submit",className:"w-full py-4",isLoading:w,children:t==="email"?"Send Code":t==="otp"?"Verify Code":"Update Password"})]})]})})]})};export{O as Login};
