import{j as e,a as U,u as A}from"./index-CRKTpU-g.js";import{r as l,m as a,A as j,a9 as P,ac as $,ad as T,z as g,S as O,ae as v,s as S,af as z,ag as w,ah as D,ai as W,aj as E,a5 as L,e as F,K as M,P as R,ak as J,al as X,k as V,am as H}from"./vendor-ui-BWBM4E-P.js";import{u as N,a as k,b as I}from"./roomsStore-pyncu6_s.js";import"./i18n-lib-Bl3zpvLj.js";const K=()=>{const{user:t}=N(),[x,n]=l.useState(!1),o=()=>{t!=null&&t.id&&(navigator.clipboard.writeText(t.id),n(!0),g.success("User ID copied!"),setTimeout(()=>n(!1),2e3))};return t?e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-3xl bg-white/[0.03] backdrop-blur-xl border border-white/[0.08] p-6 shadow-2xl h-full",children:[e.jsx("div",{className:"absolute -top-12 -right-12 w-36 h-36 bg-purple-500/10 blur-[60px] rounded-full pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-12 -left-12 w-36 h-36 bg-blue-500/8 blur-[60px] rounded-full pointer-events-none"}),e.jsxs("div",{className:"relative z-10 flex items-center gap-5",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden border-2 border-white/[0.08] shadow-lg",children:e.jsx("img",{src:t.avatar,alt:t.username,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-[#0a0a0f] rounded-full flex items-center justify-center",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${t.isOnline?"bg-green-500 animate-pulse":"bg-gray-500"}`})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xl font-black tracking-tight text-white mb-1.5 truncate",children:t.username}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/[0.04] border border-white/[0.06] text-[10px] font-mono text-gray-500 tracking-wider truncate max-w-[160px]",children:t.id}),e.jsx("button",{onClick:o,className:"p-1.5 rounded-lg hover:bg-white/[0.08] text-gray-500 hover:text-white transition-all duration-200",children:e.jsx(j,{mode:"wait",children:x?e.jsx(a.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:e.jsx(P,{size:12,className:"text-green-400"})},"check"):e.jsx(a.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:e.jsx($,{size:12})},"copy")})})]})]}),e.jsxs("div",{className:"hidden sm:flex px-3 py-1.5 rounded-xl bg-green-500/10 border border-green-500/20 text-green-400 text-[10px] font-bold uppercase tracking-widest items-center gap-1.5 shrink-0",children:[e.jsx(T,{size:12}),"Online"]})]})]}):null},Y=()=>{const[t,x]=l.useState(""),[n,o]=l.useState(!1),[m,r]=l.useState(!1),[h,i]=l.useState(null),[p,u]=l.useState(!1),[c,d]=l.useState(null),{addFriend:b}=k();l.useEffect(()=>{const y=setTimeout(async()=>{if(t.length>20){o(!0),i(null);try{const{data:C}=await U.get(`/user/search-id/${t}`);C.success&&d(C.data)}catch{d(null)}finally{o(!1)}}else d(null)},500);return()=>clearTimeout(y)},[t]);const s=async f=>{if(f.preventDefault(),!!t.trim()){r(!0),i(null);try{await b(t.trim()),u(!0),g.success("Friend added!"),setTimeout(()=>{x(""),d(null),u(!1)},1500)}catch(y){i(y.message||"Failed to add friend"),g.error(y.message||"Failed to add friend")}finally{r(!1)}}};return e.jsx("div",{className:"w-full",children:e.jsxs("form",{onSubmit:s,className:"relative space-y-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(O,{className:`w-4 h-4 transition-colors duration-200 ${h?"text-red-400":"text-gray-600 group-focus-within:text-purple-400"}`})}),e.jsx("input",{type:"text",value:t,onChange:f=>{x(f.target.value),i(null),u(!1)},placeholder:"Paste User ID here",className:`w-full pl-11 pr-12 py-3.5 bg-white/[0.04] border rounded-2xl text-white placeholder-gray-600 focus:outline-none focus:ring-2 transition-all duration-200 text-sm ${h?"border-red-500/30 focus:ring-red-500/20":p?"border-green-500/30 focus:ring-green-500/20":"border-white/[0.06] focus:border-purple-500/30 focus:ring-purple-500/20 hover:border-white/[0.1]"}`}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center",children:n&&e.jsx(v,{className:"w-4 h-4 text-purple-400 animate-spin"})})]}),e.jsxs(j,{mode:"wait",children:[p&&e.jsxs(a.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"p-4 bg-green-500/10 border border-green-500/20 rounded-2xl flex items-center gap-3 text-green-400",children:[e.jsx(S,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Friend added successfully!"})]},"success"),c&&!p&&e.jsxs(a.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"p-4 bg-white/[0.04] border border-white/[0.08] rounded-2xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:c.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${c.name}`,alt:c.name,className:"w-10 h-10 rounded-full border border-white/[0.08]"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white text-sm",children:c.name}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono truncate max-w-[120px]",children:c.id})]})]}),e.jsxs("button",{type:"submit",disabled:m,className:"flex items-center gap-1.5 px-4 py-2 bg-purple-500 hover:bg-purple-400 text-white text-xs font-bold rounded-xl shadow-lg shadow-purple-500/20 transition-all duration-200 active:scale-95 disabled:opacity-50",children:[m?e.jsx(v,{size:12,className:"animate-spin"}):e.jsx(z,{size:12}),"Add Friend"]})]},"found"),h&&e.jsxs(a.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"p-3 bg-red-500/10 border border-red-500/20 rounded-xl flex items-center gap-2 text-red-400 text-xs font-medium",children:[e.jsx(w,{size:14}),h]},"error")]})]})})},_=({friend:t,index:x})=>{const{removeFriend:n,inviteFriend:o,pendingInvites:m}=k(),r=m.includes(t.id),[h,i]=l.useState(!1),p=d=>{switch(d){case"online":return"bg-green-500";case"watching":return"bg-blue-500";case"in-room":return"bg-purple-500";default:return"bg-gray-500"}},u=d=>{switch(d){case"online":return"Online";case"watching":return"Watching Anime";case"in-room":return"In a Party";default:return"Offline"}},c=()=>{n(t.id),g.success(`${t.username} removed`),i(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(a.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:x*.04,duration:.2},className:"group relative bg-white/[0.03] border border-white/[0.06] hover:border-white/[0.12] rounded-2xl p-4 transition-all duration-200 hover:bg-white/[0.05] flex items-center gap-4",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl overflow-hidden bg-dark-bg",children:e.jsx("img",{src:t.avatar,alt:t.username,className:"w-full h-full object-cover"})}),e.jsx("div",{className:`absolute -bottom-1 -right-1 w-3.5 h-3.5 rounded-full border-2 border-[#0a0a0f] ${p(t.status)} ${t.status==="online"?"animate-pulse":""}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-white text-sm truncate",children:t.username}),e.jsx("p",{className:`text-xs truncate ${t.status==="offline"?"text-gray-600":"text-gray-400"}`,children:u(t.status)})]}),e.jsxs("div",{className:"flex items-center gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx("button",{onClick:()=>o(t.id),disabled:r||t.status==="offline",className:`p-2 rounded-lg transition-all duration-200 ${r?"bg-purple-500/20 text-purple-400":t.status==="offline"?"text-gray-600 cursor-not-allowed":"hover:bg-purple-500/10 text-gray-400 hover:text-purple-400"}`,title:"Invite to Party",children:r?e.jsx(D,{size:16,className:"animate-pulse"}):e.jsx(W,{size:16})}),e.jsx("button",{onClick:()=>i(!0),className:"p-2 rounded-lg hover:bg-red-500/10 text-gray-400 hover:text-red-400 transition-all duration-200",title:"Remove Friend",children:e.jsx(E,{size:16})})]})]}),e.jsx(j,{children:h&&e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>i(!1),children:e.jsxs(a.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:d=>d.stopPropagation(),className:"bg-[#151520] border border-white/[0.08] rounded-2xl p-6 max-w-xs w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/10 border border-red-500/20 rounded-xl",children:e.jsx(L,{size:16,className:"text-red-400"})}),e.jsx("h3",{className:"font-bold text-white",children:"Remove Friend"})]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-5",children:["Remove ",e.jsx("span",{className:"text-white font-semibold",children:t.username})," from your friends list?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-white/[0.06] hover:bg-white/[0.1] border border-white/[0.08] rounded-xl text-sm font-medium text-gray-300 transition-all duration-200",children:"Cancel"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-red-500 hover:bg-red-600 rounded-xl text-sm font-bold text-white shadow-lg shadow-red-500/20 transition-all duration-200 active:scale-95",children:"Remove"})]})]})})})]})},q=()=>{const[t,x]=l.useState(""),[n,o]=l.useState(null),[m,r]=l.useState(!1),{joinRoom:h,isRoomLoading:i}=I(),{user:p}=N(),u=F(),c=b=>{const s=b.toUpperCase();if(x(s),o(null),!s){r(!1);return}if(!s.startsWith("ROOM-")){o("Must start with ROOM-"),r(!1);return}if(s.length<9){r(!1);return}r(!0)},d=async b=>{if(b.preventDefault(),!(!t.trim()||!p||!m))try{await h(t.trim(),p),g.success("Joined room!"),u(`/party/${t}`)}catch(s){o(s.message||"Failed to join room"),g.error(s.message||"Failed to join room")}};return e.jsxs("form",{onSubmit:d,className:"w-full",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",value:t,onChange:b=>c(b.target.value),placeholder:"ROOM-XXXX",maxLength:16,className:`w-full pl-5 pr-14 py-3.5 bg-white/[0.04] border rounded-2xl text-white placeholder-gray-600 font-mono focus:outline-none focus:ring-2 transition-all duration-200 text-sm ${n?"border-red-500/30 focus:ring-red-500/20":m?"border-green-500/30 focus:ring-green-500/20":"border-white/[0.06] focus:ring-purple-500/20 focus:border-purple-500/30 hover:border-white/[0.1]"}`}),t&&!i&&e.jsx("div",{className:"absolute right-14 top-1/2 -translate-y-1/2",children:n?e.jsx(w,{size:14,className:"text-red-400"}):m?e.jsx(M,{size:14,className:"text-green-400"}):null}),e.jsx("div",{className:"absolute inset-y-0 right-2 flex items-center",children:e.jsx(j,{mode:"wait",children:i?e.jsx(a.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"p-2",children:e.jsx(v,{className:"w-5 h-5 text-purple-400 animate-spin"})},"loading"):e.jsx(a.button,{whileHover:{scale:1.05},whileTap:{scale:.9},type:"submit",disabled:!m,className:"p-2.5 bg-gradient-to-r from-purple-500 to-blue-600 text-white rounded-xl shadow-lg disabled:opacity-30 disabled:cursor-not-allowed disabled:shadow-none transition-all duration-200",children:e.jsx(R,{size:16,fill:"currentColor"})},"join")})})]}),e.jsx(j,{children:n&&e.jsxs(a.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-red-400 text-xs mt-2 ml-1 font-medium flex items-center gap-1",children:[e.jsx(w,{size:11})," ",n]})})]})},ee=()=>{const{user:t,initUser:x}=N(),{user:n}=A(),{friends:o}=k(),{createRoom:m,isRoomLoading:r}=I(),h=F(),[i,p]=l.useState("all"),[u,c]=l.useState(!1);l.useEffect(()=>{x(n)},[n,x]);const d=async()=>{if(!(!t||r))try{const s=await m(t);c(!0),g.success("Room created!"),setTimeout(()=>h(`/party/${s}`),600)}catch{g.error("Failed to create room. Try again.")}},b=o.filter(s=>i==="online"?s.status==="online"||s.status==="watching":i==="in-room"?s.status==="in-room":!0);return t?e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white pt-24 pb-12 overflow-x-hidden",children:[e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] bg-purple-600/8 blur-[180px] rounded-full"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[40%] h-[40%] bg-blue-600/6 blur-[180px] rounded-full"}),e.jsx("div",{className:"absolute top-[40%] right-[20%] w-[25%] h-[25%] bg-primary/5 blur-[120px] rounded-full"})]}),e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl relative z-10",children:[e.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 border border-purple-500/20 rounded-xl",children:e.jsx(J,{size:20,className:"text-purple-400"})}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-purple-400",children:"Watch Together"})]}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-black tracking-tight",children:["Watch ",e.jsx("span",{className:"bg-gradient-to-r from-primary via-purple-400 to-blue-400 bg-clip-text text-transparent",children:"Party"})]}),e.jsx("p",{className:"text-gray-500 mt-2 max-w-lg",children:"Create a room, invite friends, and watch anime together in perfect sync."})]}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-8 mb-16",children:[e.jsx(a.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.1},className:"w-full xl:w-[380px] shrink-0",children:e.jsx(K,{})}),e.jsxs("div",{className:"flex-1 grid md:grid-cols-2 gap-6",children:[e.jsxs(a.button,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.15},whileHover:{scale:1.015,y:-2},whileTap:{scale:.985},onClick:d,disabled:r||u,className:"relative bg-white/[0.03] backdrop-blur-xl border border-white/[0.08] rounded-3xl p-8 text-left hover:border-purple-500/30 transition-all duration-200 group overflow-hidden disabled:pointer-events-none",children:[e.jsx("div",{className:"absolute -top-12 -right-12 w-40 h-40 bg-purple-500/10 blur-3xl rounded-full group-hover:bg-purple-500/20 transition-all duration-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6 shadow-lg shadow-purple-500/20 group-hover:scale-110 group-hover:shadow-purple-500/40 transition-all duration-300",children:e.jsx(j,{mode:"wait",children:r?e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"},"spin"):u?e.jsx(a.div,{initial:{scale:0},animate:{scale:1},className:"text-white",children:e.jsx(S,{size:28})},"check"):e.jsx(a.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:e.jsx(X,{size:28,className:"text-white"})},"plus")})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Create Room"}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed",children:"Start a new watch party and invite your friends instantly."}),e.jsxs("div",{className:"mt-4",children:[r&&e.jsx("span",{className:"text-xs text-purple-400 font-medium animate-pulse",children:"Creating room…"}),u&&e.jsx("span",{className:"text-xs text-green-400 font-medium",children:"✓ Room created! Redirecting…"})]})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white/[0.03] backdrop-blur-xl border border-white/[0.08] rounded-3xl p-8 flex flex-col justify-center",children:[e.jsx("div",{className:"w-14 h-14 bg-white/[0.06] border border-white/[0.08] rounded-2xl flex items-center justify-center mb-6",children:e.jsx(R,{size:28,className:"text-white ml-1",fill:"currentColor"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Join Party"}),e.jsx(q,{})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs(a.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white/[0.03] backdrop-blur-xl border border-white/[0.08] rounded-3xl p-8 h-fit",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2.5 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:e.jsx(z,{size:20,className:"text-blue-400"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Add Friends"})]}),e.jsx(Y,{})]}),e.jsxs(a.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.35},className:"lg:col-span-2 bg-white/[0.03] backdrop-blur-xl border border-white/[0.08] rounded-3xl p-8 min-h-[400px]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:["Your Friends",e.jsx("span",{className:"bg-white/[0.08] text-gray-300 text-sm px-3 py-1 rounded-full font-medium",children:o.length})]}),e.jsx("div",{className:"flex bg-white/[0.04] border border-white/[0.06] rounded-xl p-1 gap-1",children:[{key:"all",label:"All"},{key:"online",label:"Online"},{key:"in-room",label:"In Party"}].map(s=>e.jsx("button",{onClick:()=>p(s.key),className:`px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all duration-200 ${i===s.key?"bg-purple-500/20 text-purple-300 shadow-sm":"text-gray-500 hover:text-gray-300"}`,children:s.label},s.key))})]}),o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white/[0.04] border border-white/[0.06] rounded-3xl flex items-center justify-center mb-5",children:e.jsx(V,{size:36,className:"text-gray-600"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No friends yet"}),e.jsx("p",{className:"text-gray-500 max-w-sm text-sm leading-relaxed",children:'Share your User ID with friends or paste theirs in the "Add Friends" box.'})]}):b.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(H,{size:32,className:"text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No friends match this filter."})]}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:b.map((s,f)=>e.jsx(_,{friend:s,index:f},s.id))})]})]})]})]}):e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white pt-24 pb-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsx("div",{className:"h-10 w-64 bg-white/5 rounded-2xl animate-pulse mb-8"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-12",children:[e.jsx("div",{className:"h-56 bg-white/[0.03] rounded-3xl animate-pulse"}),e.jsx("div",{className:"h-56 bg-white/[0.03] rounded-3xl animate-pulse"})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"h-48 bg-white/[0.03] rounded-3xl animate-pulse"},s))})]})})};export{ee as default};
