import{j as e,B as q}from"./index-CRKTpU-g.js";import{r as a,$ as B,ax as ee,ay as te,az as se,P,aA as re,aB as ae,aC as ne,aD as ie,aE as le,aF as oe}from"./vendor-ui-BWBM4E-P.js";import{u as ce}from"./i18n-lib-Bl3zpvLj.js";const xe=({url:m,qualities:r,onEnded:w,title:K,externalState:x,onStateChange:de,isSyncing:Q})=>{const i=a.useRef(null),b=a.useRef(null),[d,S]=a.useState(!1),[j,M]=a.useState(0),[N,U]=a.useState(0),[R,W]=a.useState(1),[g,L]=a.useState(!1),[k,C]=a.useState(!0),[p,X]=a.useState("1080p"),[f,T]=a.useState(!1),{t:Z}=ce(),[G,$]=a.useState(!1),u=a.useRef(),E=a.useRef(0),I=(()=>{switch(p){case"720p":return(r==null?void 0:r["720p"])||m;case"1080p":return(r==null?void 0:r["1080p"])||m;case"1440p":return(r==null?void 0:r["4k"])||(r==null?void 0:r["1080p"])||m;case"4K (AI)":return(r==null?void 0:r["4k"])||(r==null?void 0:r["1080p"])||m;default:return m}})(),H=(()=>{switch(p){case"720p":return{filter:"contrast(1.05) saturate(1.1) brightness(1.05)",imageRendering:"auto"};case"1080p":return{filter:"contrast(1.1) saturate(1.2) brightness(1.05)",imageRendering:"auto"};case"1440p":return{filter:"contrast(1.15) saturate(1.3) brightness(1.08)",imageRendering:"high-quality"};case"4K (AI)":return{filter:"contrast(1.2) saturate(1.4) brightness(1.1)",imageRendering:"high-quality"};default:return{filter:"none"}}})(),O=t=>{var c,o;if(t===p)return;const s=((c=i.current)==null?void 0:c.currentTime)||0,l=!((o=i.current)!=null&&o.paused);X(t),T(!1);const n=i.current;if(n){const h=()=>{if(n.currentTime=s,l){const D=n.play();D!==void 0&&D.catch(()=>{})}n.removeEventListener("loadeddata",h)};n.addEventListener("loadeddata",h)}},F=a.useCallback(()=>{d&&(C(!1),T(!1))},[d]),y=a.useCallback(()=>{C(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(F,4e3)},[F]);a.useEffect(()=>{const t=i.current;if(!t)return;const s=()=>M(t.currentTime),l=()=>U(t.duration),n=()=>{S(!1),w&&w()};return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",l),t.addEventListener("ended",n),Q&&x&&t&&(Math.abs(t.currentTime-x.currentTime)>1.5&&(t.currentTime=x.currentTime),x.isPlaying&&t.paused&&t.play(),!x.isPlaying&&!t.paused&&t.pause()),u.current&&clearTimeout(u.current),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",l),t.removeEventListener("ended",n),u.current&&clearTimeout(u.current)}},[w,I]);const A=()=>{i.current&&(d?i.current.pause():i.current.play(),S(!d),y())},V=()=>{b.current&&(document.fullscreenElement?(document.exitFullscreen(),$(!1)):(b.current.requestFullscreen(),$(!0)))},J=t=>{var o;const s=Date.now(),l=s-E.current,n=((o=b.current)==null?void 0:o.offsetWidth)||0,c=t.nativeEvent.offsetX;l<300?(c>n*.7?i.current&&(i.current.currentTime+=5):c<n*.3?i.current&&(i.current.currentTime-=5):V(),E.current=0):(A(),E.current=s)},Y=t=>{const s=parseFloat(t.target.value);i.current&&(i.current.currentTime=s,M(s)),y()},_=t=>{const s=Math.floor(t/60),l=Math.floor(t%60);return`${s}:${l<10?"0":""}${l}`},[v,z]=a.useState(null);return a.useEffect(()=>{var s,l;const t=m;if(t.includes("t.me/")){const n=(s=t.split("t.me/")[1])==null?void 0:s.split("?")[0];if(n){z(`telegram:${n}`);const c=document.getElementById("telegram-post-container");c&&(c.innerHTML="");const o=document.createElement("script");o.src="https://telegram.org/js/telegram-widget.js?22",o.setAttribute("data-telegram-post",n),o.setAttribute("data-width","100%"),o.async=!0,setTimeout(()=>{const h=document.getElementById("telegram-post-container");h&&h.appendChild(o)},100)}}else if(t.includes("youtube.com/watch?v=")||t.includes("youtu.be/")){const n=((l=t.split("v=")[1])==null?void 0:l.split("&")[0])||t.split("/").pop();z(`https://www.youtube.com/embed/${n}`)}else z(null)},[m]),e.jsxs("div",{ref:b,className:`relative group w-full aspect-video bg-black rounded-3xl overflow-hidden shadow-2xl border border-dark-border/30 transition-all duration-700 ${k?"cursor-default":"cursor-none"}`,onMouseMove:y,onMouseLeave:()=>d&&C(!1),onTouchStart:y,children:[v?v.startsWith("telegram:")?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black p-4 overflow-y-auto",children:e.jsx("div",{id:"telegram-post-container",className:"w-full max-w-md"})}):e.jsx("iframe",{src:v,className:"w-full h-full border-none",allowFullScreen:!0,allow:"autoplay; encrypted-media"}):e.jsx("video",{ref:i,src:I,className:"w-full h-full object-contain transition-all duration-500",style:{...H,backfaceVisibility:"hidden",transform:"translateZ(0)"},onClick:J,playsInline:!0}),!v&&e.jsxs("div",{className:`absolute inset-0 flex flex-col justify-between p-4 md:p-10 transition-all duration-500 ease-in-out pointer-events-none ${k?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between pointer-events-auto transform transition-transform duration-500 delay-75 translate-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-4 bg-black/40 backdrop-blur-xl border border-white/10 px-4 md:px-6 py-2 md:py-3 rounded-xl md:rounded-2xl max-w-[70%]",children:[e.jsx("div",{className:"w-1.5 h-1.5 md:w-2 md:h-2 bg-primary rounded-full animate-pulse shadow-[0_0_10px_rgba(255,59,48,0.8)] shrink-0"}),e.jsx("h3",{className:"text-xs md:text-lg font-black italic uppercase tracking-tighter text-white truncate",children:K||"ANILEGEON Premium Player"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(q,{variant:"ghost",size:"icon",onClick:()=>T(!f),"aria-label":"Video settings and quality",className:`w-9 h-9 md:w-10 md:h-10 bg-black/40 backdrop-blur-xl border border-white/10 text-white hover:text-primary transition-all pointer-events-auto ${f?"text-primary border-primary/50":""}`,children:[e.jsx(B,{size:18,className:f?"rotate-90 transition-transform":"md:hidden"}),e.jsx(B,{size:20,className:f?"rotate-90 transition-transform":"hidden md:block"})]})})]}),f&&e.jsxs("div",{className:"absolute top-16 md:top-24 right-4 md:right-10 w-48 md:w-56 bg-black/80 backdrop-blur-2xl border border-white/10 rounded-2xl md:rounded-3xl p-2 md:p-3 shadow-2xl z-50 pointer-events-auto animate-in fade-in zoom-in duration-200",children:[e.jsx("div",{className:"text-[9px] md:text-[10px] font-black uppercase tracking-[0.2em] text-gray-500 px-3 md:px-4 py-1.5 md:py-2 border-b border-white/5 mb-1 md:mb-2",children:Z("watchParty.select_anime")}),["720p","1080p","1440p","4K (AI)"].map(t=>e.jsxs("button",{onClick:()=>O(t),className:`w-full flex items-center justify-between px-4 py-3 rounded-2xl text-xs font-bold transition-all ${p===t?"bg-primary text-white shadow-lg shadow-primary/20":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsxs("span",{className:"flex items-center gap-3",children:[t==="4K (AI)"?e.jsx(ee,{size:14,className:"text-yellow-400"}):e.jsx(te,{size:14}),t]}),p===t&&e.jsx(se,{size:14})]},t))]}),e.jsx("div",{className:"flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:`transform transition-all duration-500 ${!d&&k?"scale-100 opacity-100":"scale-150 opacity-0"}`,children:e.jsxs("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-primary/20 backdrop-blur-3xl border border-primary/30 rounded-full flex items-center justify-center",children:[e.jsx(P,{size:24,className:"text-white fill-white ml-1 md:hidden"}),e.jsx(P,{size:40,className:"text-white fill-white ml-2 hidden md:block"})]})})}),e.jsxs("div",{className:"space-y-6 pointer-events-auto transform transition-transform duration-500 translate-y-0",children:[e.jsxs("div",{className:"relative group/progress h-2 w-full bg-white/10 rounded-full cursor-pointer overflow-hidden backdrop-blur-sm",children:[e.jsx("input",{type:"range",min:"0",max:N||0,value:j,onChange:Y,"aria-label":"Seek video",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-primary to-orange-500 shadow-[0_0_15px_rgba(255,59,48,0.5)] transition-all duration-100",style:{width:`${j/N*100}%`}})]}),e.jsxs("div",{className:"flex items-center justify-between bg-black/60 md:bg-black/40 backdrop-blur-2xl border border-white/10 p-3 md:p-4 rounded-xl md:rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[e.jsx("button",{onClick:A,"aria-label":d?"Pause video":"Play video",className:"text-white hover:text-primary transition-all transform active:scale-90",children:d?e.jsx(re,{size:24,className:"md:w-8 md:h-8",fill:"currentColor"}):e.jsx(P,{size:24,className:"md:w-8 md:h-8",fill:"currentColor"})}),e.jsxs("div",{className:"text-[10px] md:text-xs font-black tracking-[0.1em] md:tracking-[0.2em] text-gray-300 font-mono",children:[e.jsx("span",{className:"text-white",children:_(j)}),e.jsx("span",{className:"mx-1.5 md:mx-3 opacity-30",children:"/"}),e.jsx("span",{className:"opacity-50",children:_(N)})]})]}),e.jsxs("div",{className:"flex items-center gap-3 md:gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 group/volume",children:[e.jsx("button",{onClick:()=>L(!g),"aria-label":g?"Unmute video":"Mute video",className:"text-gray-400 hover:text-white transition-colors",children:g||R===0?e.jsx(ae,{size:18,className:"md:w-[22px] md:h-[22px]"}):e.jsx(ne,{size:18,className:"md:w-[22px] md:h-[22px]"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:g?0:R,onChange:t=>{const s=parseFloat(t.target.value);W(s),i.current&&(i.current.volume=s),L(s===0)},"aria-label":"Change volume",className:"w-16 md:w-20 accent-primary opacity-0 group-hover/volume:opacity-100 transition-all cursor-pointer hidden md:block"})]}),e.jsx("div",{className:"h-4 md:h-6 w-px bg-white/10"}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx("div",{className:"text-[8px] md:text-[10px] font-black uppercase tracking-widest text-primary px-1.5 md:px-3 py-0.5 md:py-1 bg-primary/10 border border-primary/20 rounded-md md:rounded-lg",children:p}),e.jsx("button",{onClick:V,"aria-label":G?"Exit fullscreen":"Enter fullscreen",className:"text-gray-400 hover:text-white transition-all transform hover:scale-110 active:scale-90",children:e.jsx(ie,{size:18,className:"md:w-[22px] md:h-[22px]"})})]})]})]})]})]}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx("div",{className:"flex-1 flex items-center justify-start pl-20 opacity-0 group-active:opacity-20 transition-opacity",children:e.jsx(le,{size:64,className:"text-white"})}),e.jsx("div",{className:"flex-1 flex items-center justify-end pr-20 opacity-0 group-active:opacity-20 transition-opacity",children:e.jsx(oe,{size:64,className:"text-white"})})]})]})};export{xe as V};
